<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Shader Language Server (LS) | Jen-Chieh's Website</title>
<meta name=keywords content="LSP"><meta name=description content="
Repo Link: https://github.com/shader-ls/shader-language-server

April 30th, 2023. I have created my first language server that is actually
useful to someone. I tried a language server a while back, but it was just
an example server, so itâ€™s not very useful, and itâ€™s only for educational
purposes.
The target language I chose to write is the ShaderLab language.
ShaderLab is used in Unity Engine, so you can write custom shaders
to stylize your game. Unlike regular programming languages, ShaderLab
is much simpler to analyze, so the language server can respond to the
client side."><meta name=author content="Jen-Chieh Shen"><link rel=canonical href=https://www.jcs-profile.com/posts/lsp/shader-ls/><link crossorigin=anonymous href=/assets/css/stylesheet.10865c4b1b2c43287bba4052ebb8a4e620e0b2e0a66e319556682d1d0d6e0496.css integrity="sha256-EIZcSxssQyh7ukBS67ik5iDgsuCmbjGVVmgtHQ1uBJY=" rel="preload stylesheet" as=style><link rel=icon href=https://www.jcs-profile.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.jcs-profile.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.jcs-profile.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.jcs-profile.com/apple-touch-icon.png><link rel=mask-icon href=https://www.jcs-profile.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-tw href=https://www.jcs-profile.com/zh-tw/posts/lsp/shader-ls/><link rel=alternate hreflang=en href=https://www.jcs-profile.com/posts/lsp/shader-ls/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-3MLWCB75D6"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3MLWCB75D6")}</script><meta property="og:url" content="https://www.jcs-profile.com/posts/lsp/shader-ls/"><meta property="og:site_name" content="Jen-Chieh's Website"><meta property="og:title" content="Shader Language Server (LS)"><meta property="og:description" content=" Repo Link: https://github.com/shader-ls/shader-language-server
April 30th, 2023. I have created my first language server that is actually useful to someone. I tried a language server a while back, but it was just an example server, so itâ€™s not very useful, and itâ€™s only for educational purposes.
The target language I chose to write is the ShaderLab language. ShaderLab is used in Unity Engine, so you can write custom shaders to stylize your game. Unlike regular programming languages, ShaderLab is much simpler to analyze, so the language server can respond to the client side."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-23T00:00:00+00:00"><meta property="article:tag" content="LSP"><meta property="og:image" content="https://www.jcs-profile.com/cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.jcs-profile.com/cover.png"><meta name=twitter:title content="Shader Language Server (LS)"><meta name=twitter:description content="
Repo Link: https://github.com/shader-ls/shader-language-server

April 30th, 2023. I have created my first language server that is actually
useful to someone. I tried a language server a while back, but it was just
an example server, so itâ€™s not very useful, and itâ€™s only for educational
purposes.
The target language I chose to write is the ShaderLab language.
ShaderLab is used in Unity Engine, so you can write custom shaders
to stylize your game. Unlike regular programming languages, ShaderLab
is much simpler to analyze, so the language server can respond to the
client side."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.jcs-profile.com/posts/"},{"@type":"ListItem","position":2,"name":"Shader Language Server (LS)","item":"https://www.jcs-profile.com/posts/lsp/shader-ls/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Shader Language Server (LS)","name":"Shader Language Server (LS)","description":" Repo Link: https://github.com/shader-ls/shader-language-server\nApril 30th, 2023. I have created my first language server that is actually useful to someone. I tried a language server a while back, but it was just an example server, so itâ€™s not very useful, and itâ€™s only for educational purposes.\nThe target language I chose to write is the ShaderLab language. ShaderLab is used in Unity Engine, so you can write custom shaders to stylize your game. Unlike regular programming languages, ShaderLab is much simpler to analyze, so the language server can respond to the client side.\n","keywords":["LSP"],"articleBody":" Repo Link: https://github.com/shader-ls/shader-language-server\nApril 30th, 2023. I have created my first language server that is actually useful to someone. I tried a language server a while back, but it was just an example server, so itâ€™s not very useful, and itâ€™s only for educational purposes.\nThe target language I chose to write is the ShaderLab language. ShaderLab is used in Unity Engine, so you can write custom shaders to stylize your game. Unlike regular programming languages, ShaderLab is much simpler to analyze, so the language server can respond to the client side.\nâ“ Why chose C# as the implementaion language? Since Unity Engineâ€™s most popular scripting language is C#, I reckon choosing C# is the perfect match.\nğŸ’€ C# Language Server Protocal Hell I already had a bad feeling when writing a language server in C# before starting it since I never had a good impression of the author Omnisharpâ€™s plugins. Iâ€™ve tried their official C# plugins on the VSCode Marketplace, but to be honest, I wouldnâ€™t say I like it. Here are a few reasons why:\nItâ€™s slow Constant breaking changes. Next update nothing works! Maintainers are not very active (but the community is friendly though) Nevertheless, I insist on giving csharp-language-server-protocol a shot since there are no other reasonable alternatives. After digging it for a few days, here are issues I am facing:\nExample from the official repository is either broken or incomplete (kinda useless) Obsolete or lack of documentation They donâ€™t really care about other editors. (Many editor compatible issues and PRs are left opened) Fortunately, I found the thousand language server created by @gulbanana and HlslTools created by @tgjones. Therefore, I am able to accomplish this project by seeing their implementations! ğŸ˜…ğŸ˜‡\nP.S. It took me very long to figure things out!!! ğŸ’€\nâš™ï¸ Plug-in ShaderlabVS Another challenge is the engine of the language server. What parses the text document and gives reasonable responses to the client? Then I found a project that already does that for me â€“ ShaderlabVS. Itâ€™s an ideal solution since the implementation are also in C#. Thanks to the author @wudixiaop for this amazing project! â¤ï¸\nğŸ’¥ Create a language server client Okay, now we have a language server up and running, but there is no way to test it! Iâ€™m an Emacs user, so Iâ€™ve decided to create an Emacs package â€“ lsp-shader that uses lsp-mode as the base and use it as my language serverâ€™s client. Iâ€™ve already created several language serverâ€™s clients in Emacs Lisp, so creating another isnâ€™t too difficult. ğŸ˜\nğŸ“¦ Publish on NuGet I have no experience publishing packages to NuGet, but it wasnâ€™t hard after watching a couple of tutorials on YouTube. I use the csharp-language-server created by @razzmatazz as my reference since this is the only project I know with a similar structure I want.\nIn closing, you only need two step to publish package on NuGet. ğŸ˜‹\nPack the package from Visual Studio Upload to NuGet site ğŸ–ï¸ Achievement Created a language server. Created Emacs language serverâ€™s client for shader-ls, lsp-shader. My first published NuGet package, see https://www.nuget.org/packages/shader-ls/. ","wordCount":"516","inLanguage":"en","image":"https://www.jcs-profile.com/cover.png","datePublished":"2023-08-23T00:00:00Z","dateModified":"2023-08-23T00:00:00Z","author":[{"@type":"Person","name":"Jen-Chieh Shen"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jcs-profile.com/posts/lsp/shader-ls/"},"publisher":{"@type":"Organization","name":"Jen-Chieh's Website","logo":{"@type":"ImageObject","url":"https://www.jcs-profile.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.jcs-profile.com/ accesskey=h title="Jen-Chieh's Website (Alt + H)">Jen-Chieh's Website</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://www.jcs-profile.com/zh-tw/ title=Zh-Tw aria-label=Zh-Tw>Zh-Tw</a></li></ul></div></div><ul id=menu><li><a href=https://www.jcs-profile.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://www.jcs-profile.com/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.artstation.com/jcs090218 title=Art><span>Art</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.jcs-profile.com/storage/Resume.pdf title=Resume><span>Resume</span></a></li><li><a href=https://www.jcs-profile.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.jcs-profile.com/>Home</a>&nbsp;Â»&nbsp;<a href=https://www.jcs-profile.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Shader Language Server (LS)</h1><div class=post-meta><span title='2023-08-23 00:00:00 +0000 UTC'>August 23, 2023</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;516 words&nbsp;Â·&nbsp;Jen-Chieh Shen&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://www.jcs-profile.com/zh-tw/posts/lsp/shader-ls/>Zh-Tw</a></li></ul></div></header><figure class=entry-cover><img loading=eager srcset="https://www.jcs-profile.com/posts/lsp/shader-ls/cover_hu4401647762179612327.png 360w ,https://www.jcs-profile.com/posts/lsp/shader-ls/cover_hu14892753454169190591.png 480w ,https://www.jcs-profile.com/posts/lsp/shader-ls/cover.png 500w" sizes="(min-width: 768px) 720px, 100vw" src=https://www.jcs-profile.com/posts/lsp/shader-ls/cover.png alt width=500 height=500></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#-why-chose-c-as-the-implementaion-language aria-label="â“ Why chose C# as the implementaion language?">â“ Why chose C# as the implementaion language?</a></li><li><a href=#-c-language-server-protocal-hell aria-label="ğŸ’€ C# Language Server Protocal Hell">ğŸ’€ C# Language Server Protocal Hell</a></li><li><a href=#-plug-in-shaderlabvs aria-label="âš™ï¸ Plug-in ShaderlabVS">âš™ï¸ Plug-in ShaderlabVS</a></li><li><a href=#-create-a-language-server-client aria-label="ğŸ’¥ Create a language server client">ğŸ’¥ Create a language server client</a></li><li><a href=#-publish-on-nuget aria-label="ğŸ“¦ Publish on NuGet">ğŸ“¦ Publish on NuGet</a></li><li><a href=#-achievement aria-label="ğŸ–ï¸ Achievement">ğŸ–ï¸ Achievement</a></li></ul></div></details></div><div class=post-content><blockquote><p>Repo Link: <a href=https://github.com/shader-ls/shader-language-server>https://github.com/shader-ls/shader-language-server</a></p></blockquote><p>April 30th, 2023. I have created my first language server that is actually
useful to someone. I tried a language server a while back, but it was just
an example server, so itâ€™s not very useful, and itâ€™s only for educational
purposes.</p><p>The target language I chose to write is the <a href=https://docs.unity3d.com/Manual/SL-Reference.html>ShaderLab</a> language.
ShaderLab is used in Unity Engine, so you can write custom shaders
to stylize your game. Unlike regular programming languages, <a href=https://docs.unity3d.com/Manual/SL-Reference.html>ShaderLab</a>
is much simpler to analyze, so the language server can respond to the
client side.</p><h2 id=-why-chose-c-as-the-implementaion-language>â“ Why chose C# as the implementaion language?<a hidden class=anchor aria-hidden=true href=#-why-chose-c-as-the-implementaion-language>#</a></h2><p>Since Unity Engine&rsquo;s most popular scripting language is C#, I reckon
choosing C# is the perfect match.</p><h2 id=-c-language-server-protocal-hell>ğŸ’€ C# Language Server Protocal Hell<a hidden class=anchor aria-hidden=true href=#-c-language-server-protocal-hell>#</a></h2><p>I already had a bad feeling when writing a language server in C#
before starting it since I never had a good impression of the
author <a href=https://github.com/OmniSharp>Omnisharp</a>&rsquo;s plugins. I&rsquo;ve tried their official C# plugins
on the VSCode Marketplace, but to be honest, I wouldn&rsquo;t say I like it.
Here are a few reasons why:</p><ol><li>It&rsquo;s slow</li><li>Constant breaking changes. Next update nothing works!</li><li>Maintainers are not very active (but the community is friendly though)</li></ol><p>Nevertheless, I insist on giving <a href=https://github.com/OmniSharp/csharp-language-server-protocol>csharp-language-server-protocol</a> a shot
since there are no other <strong>reasonable alternatives</strong>. After digging it for
a few days, here are issues I am facing:</p><ol><li>Example from the official repository is either <strong>broken</strong> or <strong>incomplete</strong> (kinda useless)</li><li>Obsolete or lack of documentation</li><li>They don&rsquo;t really care about other editors. (Many editor compatible issues and PRs are left opened)</li></ol><p>Fortunately, I found the <a href=https://github.com/gulbanana/thousand>thousand</a> language server created by <strong>@gulbanana</strong> and <a href=https://github.com/tgjones/HlslTools>HlslTools</a>
created by <strong>@tgjones</strong>. Therefore, I am able to accomplish this project by seeing their
implementations! ğŸ˜…ğŸ˜‡</p><p><em>P.S. It took me very long to figure things out!!!</em> ğŸ’€</p><h2 id=-plug-in-shaderlabvs>âš™ï¸ Plug-in ShaderlabVS<a hidden class=anchor aria-hidden=true href=#-plug-in-shaderlabvs>#</a></h2><p>Another challenge is the engine of the language server. What parses the text
document and gives reasonable responses to the client? Then I found a project
that already does that for me &ndash; <a href=https://github.com/wudixiaop/ShaderlabVS>ShaderlabVS</a>. It&rsquo;s an ideal solution since
the implementation are also in C#. Thanks to the author <strong>@wudixiaop</strong> for this
amazing project! â¤ï¸</p><h2 id=-create-a-language-server-client>ğŸ’¥ Create a language server client<a hidden class=anchor aria-hidden=true href=#-create-a-language-server-client>#</a></h2><p>Okay, now we have a language server up and running, but there is no way to test it!
I&rsquo;m an Emacs user, so I&rsquo;ve decided to create an Emacs package &ndash; <a href=https://github.com/shader-ls/lsp-shader>lsp-shader</a> that
uses <a href=https://github.com/emacs-lsp/lsp-mode>lsp-mode</a> as the base and use it as my language server&rsquo;s client. I&rsquo;ve already
created several language server&rsquo;s clients in Emacs Lisp, so creating another isn&rsquo;t too
difficult. ğŸ˜</p><h2 id=-publish-on-nuget>ğŸ“¦ Publish on NuGet<a hidden class=anchor aria-hidden=true href=#-publish-on-nuget>#</a></h2><p>I have no experience publishing packages to <a href=https://www.nuget.org/>NuGet</a>, but it wasn&rsquo;t hard after
watching a couple of tutorials on YouTube. I use the <a href=https://github.com/razzmatazz/csharp-language-server>csharp-language-server</a>
created by <strong>@razzmatazz</strong> as my reference since this is the only project I know
with a similar structure I want.</p><p>In closing, you only need two step to publish package on NuGet. ğŸ˜‹</p><ol><li>Pack the package from Visual Studio</li><li>Upload to NuGet site</li></ol><h2 id=-achievement>ğŸ–ï¸ Achievement<a hidden class=anchor aria-hidden=true href=#-achievement>#</a></h2><ul><li>Created a language server.</li><li>Created Emacs language server&rsquo;s client for shader-ls, <a href=https://github.com/shader-ls/lsp-shader>lsp-shader</a>.</li><li>My first published NuGet package, see <a href=https://www.nuget.org/packages/shader-ls/>https://www.nuget.org/packages/shader-ls/</a>.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.jcs-profile.com/tags/lsp/>LSP</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.jcs-profile.com/>Jen-Chieh's Website</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>